<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>group chat app</title>
</head>
<body>
    <h1 style="text-align: center;">Chat-app</h1>
        <ul id="spaceformsg"></ul>
    <form method="post" onsubmit="showmsg(event)">
            <input type="text" name="massage"> <button type="submit">send</button>
    </form>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.2/axios.min.js"></script>
   <script>
      async function showmsg(event){
        event.preventDefault();
        const massage = event.target.massage.value
        console.log(massage)
        const token = localStorage.getItem('token')
        const body = {
  massage: event.target.massage.value
}

        const response = await axios.post('http://localhost:3000/massages/chatbox', body,  { headers: { Authorization: token } })
        showallmsg()
      }

      function showallmsg(msg) {
  const showmassage = document.getElementById('spaceformsg')
  const msgElement = document.createElement('h5')
  msgElement.innerText = msg.massage
  showmassage.appendChild(msgElement)
}


      window.addEventListener('DOMContentLoaded',async ()=>{
  const token = localStorage.getItem('token')
  const allMsg = await axios.get('http://localhost:3000/massages/chatbox', { headers: { Authorization: token } })
  console.log(allMsg.data.msg)
  allMsg.data.msg.forEach(msg => {
    showallmsg(msg)
  })
})



   </script>
</html>